external printi : int -> unit

type state = { cnt : int, next : int -> int }

state = { cnt = 0, next = fun(x) x + 1 end }

fun advance(state)
  { cnt = state.next(state.cnt), next = state.next }
end

fun ten_times (state)
  if state.cnt < 10 then
    printi(state.cnt)
    ten_times(advance(state))
  else printi(100) end
end

ten_times(state)
