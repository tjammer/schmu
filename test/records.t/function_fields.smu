external printi : int -> unit

type state = { cnt : int, next : int -> int }

state = { cnt = 0, next = fun(x) -> x + 1 }

fun advance(state) =
  { cnt = state.next(state.cnt), next = state.next }

fun ten_times (state) =
  if state.cnt < 10 then
    printi(state.cnt)
    ten_times(advance(state))
  else printi(100)

ten_times(state)
