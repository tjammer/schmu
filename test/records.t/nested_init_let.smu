(type foo {:x int})

(type ys (:y foo :z int))

(external printi (fun int unit))

(fun record_with_laters []
  (val x {:x 12})
  (:y x :z 15))

(fun ctrl []
  (val ret {:y {:x 17} :z 9})
  (val a {:y {:x 1} :z 2})
  ret)

(val ys (record_with_laters))
(printi (.z ys))
(printi (.x (.y ys)))
-- should print 17 and 9
(val ctrl (ctrl))
(printi (.x (.y ctrl)))
(printi (.z ctrl))
0
