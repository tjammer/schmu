(type (foo 'a) {:a 'a :b float})

(fun test-record-in-variant [inner]
  (let [a (match (#some {:a inner :b 53.0})
            ((#some {:a (#some a) :b}) a)
            ((#some {:a #none :b}) -1)
            (#none 0))]
    (print (fmt-str a))))

(test-record-in-variant (#some 10))
(test-record-in-variant #none)

(fun test-nested-records [inner]
  (let [a (match {:a inner :b 45.0}
            ({:a {:a c :b _} :b _} c))]
    (print (fmt-str a))))

(test-nested-records {:a 20 :b 30.0})

(fun test-record-wildcard [inner]
  (let [a (match (#some {:a inner :b 53.0})
            ((#some {:a (#some a) :b _}) a)
            ((#some _) -2)
            (#none 0))]
    (print (fmt-str a))))

(test-record-wildcard #none)
