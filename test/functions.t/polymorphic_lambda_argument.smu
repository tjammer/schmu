let arr = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

fun string_add_null(str&):
  String.modify_buf(&str, fun(arr&):
    Array.push(&arr, !0u8)
    Array.drop_back(&arr))

fun string_concat(arr, delim):
  let acc& = ""
  Array.iteri(arr, fun(i, v):
    if i > 0: String.append(&acc, delim)
    String.append(&acc, fmt(v)))
  string_add_null(&acc)
  acc

print(string_concat(arr, ", "))
