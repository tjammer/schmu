external printi : int -> unit

type t('a) = { x : 'a }

fun apply(x, f , env) = f(x, env)

fun apply2(x : 'a, f : ('a, 'a -> 'b) -> 'b, env : 'a -> 'b) =
  f(x, env)

fun add1(x : int) -> int =
  x + 1

fun boxed2int_int(t, env) = do
  a = env(t.x)
  in { x = a }

a = apply({x = 15}, boxed2int_int, add1).x
printi(a)
b = apply2({x = 15}, boxed2int_int, add1).x
printi(b)
