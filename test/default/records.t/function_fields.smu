(external printi (fun int unit))

(record state {:cnt int :next (fun int int)})

(val state {:cnt 0 :next (fun [x] (+ x 1))})

(fun advance [state]
  {:cnt ((.next state) (.cnt state)) :next (.next state)})

(fun ten_times [state]
  (if (< (.cnt state) 10)
    (do
      (printi (.cnt state))
      (ten_times (advance state)))
    (printi 100)))

(ten_times state)
